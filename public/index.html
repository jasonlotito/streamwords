<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <style>
      /*@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300');*/
      /** {*/
      /*    font-family:  'Ampersand', Montserrat, sans-serif;*/
      /*}*/

      /*@font-face {*/
      /*    font-family: 'Ampersand';*/
      /*    src: local('Times New Roman');*/
      /*    unicode-range: U+0026;*/
      /*}*/

      * {
          font-family: Monospace;
      }

      input, select, button {
          padding: 5px 10px;
          font-size: 16px;
      }

      button {
          cursor: pointer;
      }

      label {
          display: inline-block;
          width: 300px;
      }

      form {
          display: flex;
          flex-direction: column;
      }

      #word {
          text-transform: uppercase;
          font-size: 5em;
      }

  </style>
</head>
<body>
<div id="word" value=""></div>
<!--<input type="text" name="name" placeholder="younow name" id="name" value="jasonml">-->
<!--<button id="connect">Connect</button>-->
<a href="" id="__refresh"></a>
<script src="/socket.io/socket.io.js"></script>
<script>
  let socket = io();
  const word = document.getElementById('word');
  const btnConnect = document.getElementById('connect');
  // const name = document.getElementById('name');
  const params = new URLSearchParams(location.search);

  var wordObserver = new MutationObserver((mutations) => {
    mutations.forEach((mutation) => {
      if(mutation.type === 'attributes') {
        if(mutation.attributeName === 'value') {
          word.innerText = word.getAttribute('value');
        }
      }
    });
  });
  wordObserver.observe(word, {
    attributes: true
  });

  // btnConnect.addEventListener('click', () => {
  //   socket.emit('join', name.value);
  // });

  socket.on('reload', function() {
    console.log('reloading game');
    document.getElementById('__refresh').setAttribute('href', document.location);
    document.getElementById('__refresh').click();
  });


  socket.on('connect', () => {
    socket.emit('join', params.get('name'));
  });


  socket.on('setWord', function(msg) {
    word.setAttribute('value', msg);
  })

  word.setAttribute('value', 'jasonml');



</script>

</body>
</html>
